I. VULNERABILITY
-------------------------
Access Control Vulnerabilities - BSA Radar (Authenticated) 

II. BACKGROUND
-------------------------
BSA Radar is a banking application provided by GLOBAL Radar which is implemented within corporate environments to perform SWIFT transactions, approve and review transactions, manage documents, manage users and roles and other features.

III. DESCRIPTION
-------------------------
Global RADAR BSA Radar 1.6.7234.24750 lacks valid authorization controls in multiple functions while logged into the application. This can allow for manipulation and takeover of user accounts if successfully exploited. 

The following vulnerable functions are exposed: ChangePassword, SaveUserProfile, GetUser

IV. History
-------------------------
The vulnerability was originally disclosed to the vendor on November 4, 2019.

V. PROOF OF CONCEPT
-------------------------
Affected components: 
1. **ChangePassword API endpoint** - Allows the ability to update the password belonging to another account by their UserID, and therefore leading to account takeover.
```
HTTP Request PoC:
POST /WS/AjaxWS.asmx/ChangePassword

{"password":{"UserID":XXXX,"IsSecurityQuestionRequired":true,"NewPassword":"NEWPASSHERE","NewPasswordConfirm":"NEWPASSHERE","SecurityQuestion":"","SecurityAnswer":""} }

The UserID and NewPassword parameters can be forged to force the password change of another existing user account by using their UserID.
```

2. **SaveUserProfile API endpoint** - Allows the ability to update the user profile belonging to another account by using their UserID. This includes modifiable details like first name, last name, email, and phone number. This also allows for injection of a Stored Cross-Site Scripting (XSS) into arbitrary user account profiles as the first name and last name parameters are vulnerable. This can allow for session hijacking, stealing application data or redirecting users to attacker-controlled applications for phishing attacks.

3. **GetUser API endpoint** - Allows the ability to view the user account details of any arbitrary user by enumerating their UserID.

VI. BUSINESS IMPACT
-------------------------
Authorization Control Issues, Account takeover, Account modifications, Disclosure of Arbitrary User Accounts

VII. SYSTEMS AFFECTED
-------------------------
BSA Radar - Version 1.6.7234.24750 and lower.

VIII. SOLUTION
-------------------------


IX. REFERENCES
-------------------------
[]()

X. CREDITS
-------------------------
This vulnerability has been discovered and reported by William Summerhill.

XI. DISCLOSURE TIMELINE
-------------------------
The vulnerability was originally disclosed to the vendor on November 4, 2019. The vulnerability was then patched and verified on April 26, 2020.
